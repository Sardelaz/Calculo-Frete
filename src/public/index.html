<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Consulta de Prazo - Azul Cargo</title>
  <style>
    body { font-family: Arial; background: #f2f2f2; padding: 20px; }
    input, button { padding: 10px; margin: 5px 0; }
    .resultado { margin-top: 20px; font-size: 18px; padding: 10px; background: #dff0d8; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>Consultar Prazo de Entrega - Azul Cargo</h2>
  <p>Digite o CEP (com ou sem traço):</p>
  <input type="text" id="cep" maxlength="9" placeholder="Ex: 24410-240">
  <p>Digite o Peso (kg):</p>
  <input type="text" id="peso" placeholder="Ex: 12,5">
  <button onclick="consultarPrazo()">Consultar</button>

  <div id="resultado" class="resultado"></div>

  <script>
    async function consultarPrazo() {
      const cepInput = document.getElementById('cep').value.replace(/\D/g, '');
      const pesoStr = document.getElementById('peso').value.trim().replace(',', '.');
      const peso = parseFloat(pesoStr);

      if (cepInput.length !== 8 || isNaN(peso) || peso <= 0) {
        document.getElementById('resultado').innerText = 'Preencha todos os campos corretamente.';
        return;
      }

      try {
        const response = await fetch(`/api/calcular?cep=${cepInput}&peso=${peso}`);
        const data = await response.json();

        if (data.error) {
          document.getElementById('resultado').innerText = data.error;
          return;
        }

        document.getElementById('resultado').innerHTML = `
          <strong>Estado (UF):</strong> ${data.uf}<br>
          <strong>Cidade:</strong> ${data.cidade}<br>
          <strong>Capital/Interior:</strong> ${data.tipo}<br>
          <strong>Prazo:</strong> ${data.prazo} dias úteis<br>
          <strong>Peso informado:</strong> ${data.peso} kg<br>
          <strong>Faixa utilizada:</strong> ${data.faixaPeso}<br>
          <strong>Frete:</strong> R$ ${data.frete}
        `;
      } catch (error) {
        document.getElementById('resultado').innerText = 'Erro ao consultar API.';
        console.error(error);
      }
    }
  </script>
</body>
</html>
